<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>An example of market-clearing assessment</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">An example of market-clearing assessment</h1>



<p>This short tutorial gives an example of statistically assessing whether a market is in an equilibrium state. The tutorial assumes some familiarity with the concepts and the functionality of the package. The <a href="basic_usage.html">basic_usage</a> vignette can be helpful in acquiring this familiarity.</p>
<div id="setup-the-environment" class="section level2">
<h2>Setup the environment</h2>
<p>Load the required libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(markets)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(magrittr)</a></code></pre></div>
<p>Prepare the data. Here, we simply simulate data using a data generating process for a market in equilibrium.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">nobs &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb2-2" title="2">tobs &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">alpha_d &lt;-<span class="st"> </span><span class="fl">-3.9</span></a>
<a class="sourceLine" id="cb2-5" title="5">beta_d0 &lt;-<span class="st"> </span><span class="fl">28.9</span></a>
<a class="sourceLine" id="cb2-6" title="6">beta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.1</span>, <span class="fl">-0.7</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">eta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">6.25</span>)</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9">alpha_s &lt;-<span class="st"> </span><span class="fl">2.8</span></a>
<a class="sourceLine" id="cb2-10" title="10">beta_s0 &lt;-<span class="st"> </span><span class="fl">26.2</span></a>
<a class="sourceLine" id="cb2-11" title="11">beta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.65</span>)</a>
<a class="sourceLine" id="cb2-12" title="12">eta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.15</span>, <span class="fl">4.2</span>)</a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14">sigma_d &lt;-<span class="st"> </span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb2-15" title="15">sigma_s &lt;-<span class="st"> </span><span class="fl">1.1</span></a>
<a class="sourceLine" id="cb2-16" title="16">rho_ds &lt;-<span class="st"> </span><span class="fl">0.0</span></a>
<a class="sourceLine" id="cb2-17" title="17"></a>
<a class="sourceLine" id="cb2-18" title="18">seed &lt;-<span class="st"> </span><span class="dv">42</span></a>
<a class="sourceLine" id="cb2-19" title="19"></a>
<a class="sourceLine" id="cb2-20" title="20">eq_data &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(</a>
<a class="sourceLine" id="cb2-21" title="21">  <span class="st">&quot;equilibrium_model&quot;</span>, nobs, tobs,</a>
<a class="sourceLine" id="cb2-22" title="22">  alpha_d, beta_d0, beta_d, eta_d,</a>
<a class="sourceLine" id="cb2-23" title="23">  alpha_s, beta_s0, beta_s, eta_s,</a>
<a class="sourceLine" id="cb2-24" title="24">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="kw">c</span>(<span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb2-25" title="25">  <span class="dt">sigma_d =</span> sigma_d, <span class="dt">sigma_s =</span> sigma_s, <span class="dt">rho_ds =</span> rho_ds,</a>
<a class="sourceLine" id="cb2-26" title="26">  <span class="dt">seed =</span> seed</a>
<a class="sourceLine" id="cb2-27" title="27">)</a></code></pre></div>
</div>
<div id="estimate-the-models" class="section level2">
<h2>Estimate the models</h2>
<p>Prepare the basic parameters for model initialization.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">verbose &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-2" title="2">correlated_shocks &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb3-3" title="3">formula &lt;-<span class="st">   </span>Q <span class="op">|</span><span class="st"> </span>P <span class="op">|</span><span class="st"> </span>id <span class="op">|</span><span class="st"> </span>date <span class="op">~</span><span class="st"> </span>P <span class="op">+</span><span class="st"> </span>Xd1 <span class="op">+</span><span class="st"> </span>Xd2 <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2 <span class="op">|</span><span class="st"> </span>P <span class="op">+</span><span class="st"> </span>Xs1 <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2</a></code></pre></div>
<p>Set the estimation parameters.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">optimization_method &lt;-<span class="st"> &quot;BFGS&quot;</span></a>
<a class="sourceLine" id="cb4-2" title="2">optimization_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">maxit =</span> <span class="dv">10000</span>, <span class="dt">reltol =</span> <span class="fl">1e-8</span>)</a></code></pre></div>
<p>Using the above parameterization, construct and estimate the model objects. Here we estimate two equilibrium models and four disequilibrium models. All the models are constructed using the simulated data from a model of market in equilibrium.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">eq_reg &lt;-<span class="st"> </span><span class="kw">equilibrium_model</span>(</a>
<a class="sourceLine" id="cb5-2" title="2">  formula, eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="dt">correlated_shocks =</span> correlated_shocks, <span class="dt">verbose =</span> verbose,</a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="dt">estimation_options =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;2SLS&quot;</span>)</a>
<a class="sourceLine" id="cb5-5" title="5">)</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; Info: This is &#39;Equilibrium with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></a>
<a class="sourceLine" id="cb5-8" title="8">eq_fit &lt;-<span class="st"> </span><span class="kw">equilibrium_model</span>(</a>
<a class="sourceLine" id="cb5-9" title="9">  formula, eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb5-10" title="10">  <span class="dt">correlated_shocks =</span> correlated_shocks, <span class="dt">verbose =</span> verbose,</a>
<a class="sourceLine" id="cb5-11" title="11">  <span class="dt">estimation_options =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb5-12" title="12">    <span class="dt">control =</span> optimization_options, <span class="dt">method =</span> optimization_method</a>
<a class="sourceLine" id="cb5-13" title="13">  )</a>
<a class="sourceLine" id="cb5-14" title="14">)</a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; Info: This is &#39;Equilibrium with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></a>
<a class="sourceLine" id="cb5-17" title="17">bs_fit &lt;-<span class="st"> </span><span class="kw">diseq_basic</span>(</a>
<a class="sourceLine" id="cb5-18" title="18">  formula, eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb5-19" title="19">  <span class="dt">correlated_shocks =</span> correlated_shocks, <span class="dt">verbose =</span> verbose,</a>
<a class="sourceLine" id="cb5-20" title="20">  <span class="dt">estimation_options =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb5-21" title="21">    <span class="dt">control =</span> optimization_options, <span class="dt">method =</span> optimization_method</a>
<a class="sourceLine" id="cb5-22" title="22">  )</a>
<a class="sourceLine" id="cb5-23" title="23">)</a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt; Info: This is &#39;Basic with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></a>
<a class="sourceLine" id="cb5-26" title="26">da_fit &lt;-<span class="st"> </span><span class="kw">diseq_deterministic_adjustment</span>(</a>
<a class="sourceLine" id="cb5-27" title="27">  formula, eq_data,</a>
<a class="sourceLine" id="cb5-28" title="28">  <span class="dt">correlated_shocks =</span> correlated_shocks, <span class="dt">verbose =</span> verbose,</a>
<a class="sourceLine" id="cb5-29" title="29">  <span class="dt">estimation_options =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb5-30" title="30">    <span class="dt">control =</span> optimization_options, <span class="dt">method =</span> optimization_method</a>
<a class="sourceLine" id="cb5-31" title="31">  )</a>
<a class="sourceLine" id="cb5-32" title="32">)</a>
<a class="sourceLine" id="cb5-33" title="33"><span class="co">#&gt; Info: This is &#39;Deterministic Adjustment with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="co">#&gt; Info: Dropping 1000 rows to generate &#39;LAGGED_P&#39;.</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="co">#&gt; Info: Sample separated with 2000 rows in excess supply and 2000 in excess demand state.</span></a></code></pre></div>
</div>
<div id="post-estimation-analysis" class="section level2">
<h2>Post estimation analysis</h2>
<div id="summaries" class="section level3">
<h3>Summaries</h3>
<p>All the models provide estimates for the simulated data. Even with simulated data, it is difficult to assess which model performs better by examining only the summaries in separation or collectively.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">summary</span>(eq_reg<span class="op">@</span>fit[[<span class="dv">1</span>]]<span class="op">$</span>first_stage_model)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; lm(formula = first_stage_formula, data = object@model_tibble)</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; Residuals:</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; -0.88388 -0.14215  0.00305  0.14088  0.81967 </span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; (Intercept)  0.402566   0.003302  121.91   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; Xd1          0.313982   0.003288   95.50   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; Xd2         -0.103262   0.003274  -31.54   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; X1           0.348932   0.003262  106.98   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; X2           0.306357   0.003222   95.07   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; Xs1         -0.398531   0.003284 -121.36   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt; Residual standard error: 0.2087 on 3994 degrees of freedom</span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt; Multiple R-squared:  0.9194, Adjusted R-squared:  0.9193 </span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="co">#&gt; F-statistic:  9110 on 5 and 3994 DF,  p-value: &lt; 2.2e-16</span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="kw">summary</span>(eq_reg)</a>
<a class="sourceLine" id="cb6-25" title="25"><span class="co">#&gt; Equilibrium Model for Markets in Equilibrium</span></a>
<a class="sourceLine" id="cb6-26" title="26"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb6-27" title="27"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="co">#&gt;   Market Clearing   : Q = D_Q = S_Q</span></a>
<a class="sourceLine" id="cb6-29" title="29"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="co">#&gt;   Nobs              : 4000</span></a>
<a class="sourceLine" id="cb6-31" title="31"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb6-32" title="32"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb6-33" title="33"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb6-35" title="35"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb6-36" title="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-37" title="37"><span class="co">#&gt; systemfit results </span></a>
<a class="sourceLine" id="cb6-38" title="38"><span class="co">#&gt; method: 2SLS </span></a>
<a class="sourceLine" id="cb6-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-40" title="40"><span class="co">#&gt;           N   DF     SSR  detRCov   OLS-R2 McElroy-R2</span></a>
<a class="sourceLine" id="cb6-41" title="41"><span class="co">#&gt; system 8000 7989 7718.08 0.833283 0.972727   0.976083</span></a>
<a class="sourceLine" id="cb6-42" title="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-43" title="43"><span class="co">#&gt;           N   DF     SSR      MSE     RMSE       R2   Adj R2</span></a>
<a class="sourceLine" id="cb6-44" title="44"><span class="co">#&gt; demand 4000 3994 2597.52 0.650356 0.806447 0.981643 0.981620</span></a>
<a class="sourceLine" id="cb6-45" title="45"><span class="co">#&gt; supply 4000 3995 5120.56 1.281742 1.132141 0.963812 0.963776</span></a>
<a class="sourceLine" id="cb6-46" title="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-47" title="47"><span class="co">#&gt; The covariance matrix of the residuals</span></a>
<a class="sourceLine" id="cb6-48" title="48"><span class="co">#&gt;            demand     supply</span></a>
<a class="sourceLine" id="cb6-49" title="49"><span class="co">#&gt; demand  0.6503560 -0.0174889</span></a>
<a class="sourceLine" id="cb6-50" title="50"><span class="co">#&gt; supply -0.0174889  1.2817422</span></a>
<a class="sourceLine" id="cb6-51" title="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-52" title="52"><span class="co">#&gt; The correlations of the residuals</span></a>
<a class="sourceLine" id="cb6-53" title="53"><span class="co">#&gt;            demand     supply</span></a>
<a class="sourceLine" id="cb6-54" title="54"><span class="co">#&gt; demand  1.0000000 -0.0191552</span></a>
<a class="sourceLine" id="cb6-55" title="55"><span class="co">#&gt; supply -0.0191552  1.0000000</span></a>
<a class="sourceLine" id="cb6-56" title="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-57" title="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-58" title="58"><span class="co">#&gt; 2SLS estimates for &#39;demand&#39; (equation 1)</span></a>
<a class="sourceLine" id="cb6-59" title="59"><span class="co">#&gt; Model Formula: Q ~ P + Xd1 + Xd2 + X1 + X2</span></a>
<a class="sourceLine" id="cb6-60" title="60"><span class="co">#&gt; &lt;environment: 0x561900c1c950&gt;</span></a>
<a class="sourceLine" id="cb6-61" title="61"><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></a>
<a class="sourceLine" id="cb6-62" title="62"><span class="co">#&gt; &lt;environment: 0x561900c1c950&gt;</span></a>
<a class="sourceLine" id="cb6-63" title="63"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-64" title="64"><span class="co">#&gt;               Estimate Std. Error  t value   Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb6-65" title="65"><span class="co">#&gt; (Intercept) 28.8908936  0.0182726 1581.108 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-66" title="66"><span class="co">#&gt; P           -3.8765576  0.0318337 -121.775 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-67" title="67"><span class="co">#&gt; Xd1          2.1050973  0.0162669  129.410 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-68" title="68"><span class="co">#&gt; Xd2         -0.7077763  0.0131230  -53.934 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-69" title="69"><span class="co">#&gt; X1           3.5074743  0.0167043  209.975 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-70" title="70"><span class="co">#&gt; X2           6.2465504  0.0158419  394.306 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-71" title="71"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb6-72" title="72"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb6-73" title="73"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-74" title="74"><span class="co">#&gt; Residual standard error: 0.806447 on 3994 degrees of freedom</span></a>
<a class="sourceLine" id="cb6-75" title="75"><span class="co">#&gt; Number of observations: 4000 Degrees of Freedom: 3994 </span></a>
<a class="sourceLine" id="cb6-76" title="76"><span class="co">#&gt; SSR: 2597.521998 MSE: 0.650356 Root MSE: 0.806447 </span></a>
<a class="sourceLine" id="cb6-77" title="77"><span class="co">#&gt; Multiple R-Squared: 0.981643 Adjusted R-Squared: 0.98162 </span></a>
<a class="sourceLine" id="cb6-78" title="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-79" title="79"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-80" title="80"><span class="co">#&gt; 2SLS estimates for &#39;supply&#39; (equation 2)</span></a>
<a class="sourceLine" id="cb6-81" title="81"><span class="co">#&gt; Model Formula: Q ~ P + Xs1 + X1 + X2</span></a>
<a class="sourceLine" id="cb6-82" title="82"><span class="co">#&gt; &lt;environment: 0x561900c1c950&gt;</span></a>
<a class="sourceLine" id="cb6-83" title="83"><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></a>
<a class="sourceLine" id="cb6-84" title="84"><span class="co">#&gt; &lt;environment: 0x561900c1c950&gt;</span></a>
<a class="sourceLine" id="cb6-85" title="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-86" title="86"><span class="co">#&gt;               Estimate Std. Error  t value   Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb6-87" title="87"><span class="co">#&gt; (Intercept) 26.1862350  0.0279220 937.8368 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-88" title="88"><span class="co">#&gt; P            2.8426868  0.0539250  52.7156 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-89" title="89"><span class="co">#&gt; Xs1          2.6776568  0.0281531  95.1107 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-90" title="90"><span class="co">#&gt; X1           1.1627870  0.0256741  45.2902 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-91" title="91"><span class="co">#&gt; X2           4.1882859  0.0242913 172.4191 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-92" title="92"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb6-93" title="93"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb6-94" title="94"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-95" title="95"><span class="co">#&gt; Residual standard error: 1.132141 on 3995 degrees of freedom</span></a>
<a class="sourceLine" id="cb6-96" title="96"><span class="co">#&gt; Number of observations: 4000 Degrees of Freedom: 3995 </span></a>
<a class="sourceLine" id="cb6-97" title="97"><span class="co">#&gt; SSR: 5120.560239 MSE: 1.281742 Root MSE: 1.132141 </span></a>
<a class="sourceLine" id="cb6-98" title="98"><span class="co">#&gt; Multiple R-Squared: 0.963812 Adjusted R-Squared: 0.963776</span></a>
<a class="sourceLine" id="cb6-99" title="99"><span class="kw">summary</span>(eq_fit)</a>
<a class="sourceLine" id="cb6-100" title="100"><span class="co">#&gt; Equilibrium Model for Markets in Equilibrium</span></a>
<a class="sourceLine" id="cb6-101" title="101"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb6-102" title="102"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb6-103" title="103"><span class="co">#&gt;   Market Clearing   : Q = D_Q = S_Q</span></a>
<a class="sourceLine" id="cb6-104" title="104"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb6-105" title="105"><span class="co">#&gt;   Nobs              : 4000</span></a>
<a class="sourceLine" id="cb6-106" title="106"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb6-107" title="107"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb6-108" title="108"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb6-109" title="109"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb6-110" title="110"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb6-111" title="111"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-112" title="112"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb6-113" title="113"><span class="co">#&gt;   Method              : BFGS</span></a>
<a class="sourceLine" id="cb6-114" title="114"><span class="co">#&gt;   Max Iterations      : 10000</span></a>
<a class="sourceLine" id="cb6-115" title="115"><span class="co">#&gt;   Relative Tolerance  : 1e-08</span></a>
<a class="sourceLine" id="cb6-116" title="116"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb6-117" title="117"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb6-118" title="118"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb6-119" title="119"><span class="co">#&gt;   -3.87656   28.89089    2.10510   -0.70778    3.50747    6.24655    2.84269 </span></a>
<a class="sourceLine" id="cb6-120" title="120"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2 D_VARIANCE S_VARIANCE        RHO </span></a>
<a class="sourceLine" id="cb6-121" title="121"><span class="co">#&gt;   26.18624    2.67766    1.16279    4.18829    0.65036    1.28174   -0.01916 </span></a>
<a class="sourceLine" id="cb6-122" title="122"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-123" title="123"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb6-124" title="124"><span class="co">#&gt;            Estimate Std. Error  z value      Pr(z)</span></a>
<a class="sourceLine" id="cb6-125" title="125"><span class="co">#&gt; D_P         -3.8766    0.03181 -121.857  0.000e+00</span></a>
<a class="sourceLine" id="cb6-126" title="126"><span class="co">#&gt; D_CONST     28.8909    0.01826 1582.297  0.000e+00</span></a>
<a class="sourceLine" id="cb6-127" title="127"><span class="co">#&gt; D_Xd1        2.1050    0.01624  129.610  0.000e+00</span></a>
<a class="sourceLine" id="cb6-128" title="128"><span class="co">#&gt; D_Xd2       -0.7079    0.01313  -53.918  0.000e+00</span></a>
<a class="sourceLine" id="cb6-129" title="129"><span class="co">#&gt; D_X1         3.5075    0.01669  210.118  0.000e+00</span></a>
<a class="sourceLine" id="cb6-130" title="130"><span class="co">#&gt; D_X2         6.2465    0.01583  394.602  0.000e+00</span></a>
<a class="sourceLine" id="cb6-131" title="131"><span class="co">#&gt; S_P          2.8430    0.05390   52.750  0.000e+00</span></a>
<a class="sourceLine" id="cb6-132" title="132"><span class="co">#&gt; S_CONST     26.1861    0.02791  938.343  0.000e+00</span></a>
<a class="sourceLine" id="cb6-133" title="133"><span class="co">#&gt; S_Xs1        2.6778    0.02814   95.168  0.000e+00</span></a>
<a class="sourceLine" id="cb6-134" title="134"><span class="co">#&gt; S_X1         1.1627    0.02566   45.310  0.000e+00</span></a>
<a class="sourceLine" id="cb6-135" title="135"><span class="co">#&gt; S_X2         4.1882    0.02428  172.510  0.000e+00</span></a>
<a class="sourceLine" id="cb6-136" title="136"><span class="co">#&gt; D_VARIANCE   0.6494    0.01584   41.010  0.000e+00</span></a>
<a class="sourceLine" id="cb6-137" title="137"><span class="co">#&gt; S_VARIANCE   1.2803    0.03540   36.169 1.881e-286</span></a>
<a class="sourceLine" id="cb6-138" title="138"><span class="co">#&gt; RHO         -0.0192    0.01807   -1.062  2.881e-01</span></a>
<a class="sourceLine" id="cb6-139" title="139"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-140" title="140"><span class="co">#&gt; -2 log L: 6722.67</span></a>
<a class="sourceLine" id="cb6-141" title="141"><span class="kw">summary</span>(bs_fit)</a>
<a class="sourceLine" id="cb6-142" title="142"><span class="co">#&gt; Basic Model for Markets in Disequilibrium</span></a>
<a class="sourceLine" id="cb6-143" title="143"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb6-144" title="144"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb6-145" title="145"><span class="co">#&gt;   Short Side Rule   : Q = min(D_Q, S_Q)</span></a>
<a class="sourceLine" id="cb6-146" title="146"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb6-147" title="147"><span class="co">#&gt;   Nobs              : 4000</span></a>
<a class="sourceLine" id="cb6-148" title="148"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb6-149" title="149"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb6-150" title="150"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb6-151" title="151"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb6-152" title="152"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb6-153" title="153"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-154" title="154"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb6-155" title="155"><span class="co">#&gt;   Method              : BFGS</span></a>
<a class="sourceLine" id="cb6-156" title="156"><span class="co">#&gt;   Max Iterations      : 10000</span></a>
<a class="sourceLine" id="cb6-157" title="157"><span class="co">#&gt;   Relative Tolerance  : 1e-08</span></a>
<a class="sourceLine" id="cb6-158" title="158"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb6-159" title="159"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb6-160" title="160"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb6-161" title="161"><span class="co">#&gt;    -3.3899    28.6909     1.9497    -0.6543     3.3398     6.0968     1.5864 </span></a>
<a class="sourceLine" id="cb6-162" title="162"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2 D_VARIANCE S_VARIANCE        RHO </span></a>
<a class="sourceLine" id="cb6-163" title="163"><span class="co">#&gt;    26.6854     2.1697     1.5963     4.5814     0.6012     1.0378     0.0000 </span></a>
<a class="sourceLine" id="cb6-164" title="164"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-165" title="165"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb6-166" title="166"><span class="co">#&gt;            Estimate Std. Error z value      Pr(z)</span></a>
<a class="sourceLine" id="cb6-167" title="167"><span class="co">#&gt; D_P         -3.5088    0.04544  -77.22  0.000e+00</span></a>
<a class="sourceLine" id="cb6-168" title="168"><span class="co">#&gt; D_CONST     29.1229    0.03412  853.59  0.000e+00</span></a>
<a class="sourceLine" id="cb6-169" title="169"><span class="co">#&gt; D_Xd1        2.0719    0.02544   81.44  0.000e+00</span></a>
<a class="sourceLine" id="cb6-170" title="170"><span class="co">#&gt; D_Xd2       -0.7088    0.01662  -42.65  0.000e+00</span></a>
<a class="sourceLine" id="cb6-171" title="171"><span class="co">#&gt; D_X1         3.3653    0.02546  132.20  0.000e+00</span></a>
<a class="sourceLine" id="cb6-172" title="172"><span class="co">#&gt; D_X2         6.1435    0.02472  248.49  0.000e+00</span></a>
<a class="sourceLine" id="cb6-173" title="173"><span class="co">#&gt; S_P          2.0706    0.10797   19.18  5.585e-82</span></a>
<a class="sourceLine" id="cb6-174" title="174"><span class="co">#&gt; S_CONST     27.8542    0.05857  475.60  0.000e+00</span></a>
<a class="sourceLine" id="cb6-175" title="175"><span class="co">#&gt; S_Xs1        2.5828    0.06431   40.16  0.000e+00</span></a>
<a class="sourceLine" id="cb6-176" title="176"><span class="co">#&gt; S_X1         1.4476    0.05402   26.80 3.340e-158</span></a>
<a class="sourceLine" id="cb6-177" title="177"><span class="co">#&gt; S_X2         4.3986    0.05373   81.86  0.000e+00</span></a>
<a class="sourceLine" id="cb6-178" title="178"><span class="co">#&gt; D_VARIANCE   0.6386    0.02336   27.34 1.359e-164</span></a>
<a class="sourceLine" id="cb6-179" title="179"><span class="co">#&gt; S_VARIANCE   1.1249    0.07243   15.53  2.131e-54</span></a>
<a class="sourceLine" id="cb6-180" title="180"><span class="co">#&gt; RHO         -0.4709    0.04036  -11.67  1.872e-31</span></a>
<a class="sourceLine" id="cb6-181" title="181"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-182" title="182"><span class="co">#&gt; -2 log L: 8338.91</span></a>
<a class="sourceLine" id="cb6-183" title="183"><span class="kw">summary</span>(da_fit)</a>
<a class="sourceLine" id="cb6-184" title="184"><span class="co">#&gt; Deterministic Adjustment Model for Markets in Disequilibrium</span></a>
<a class="sourceLine" id="cb6-185" title="185"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb6-186" title="186"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb6-187" title="187"><span class="co">#&gt;   Short Side Rule   : Q = min(D_Q, S_Q)</span></a>
<a class="sourceLine" id="cb6-188" title="188"><span class="co">#&gt;   Separation Rule   : P_DIFF analogous to (D_Q - S_Q)</span></a>
<a class="sourceLine" id="cb6-189" title="189"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb6-190" title="190"><span class="co">#&gt;   Nobs              : 4000</span></a>
<a class="sourceLine" id="cb6-191" title="191"><span class="co">#&gt;   Sample Separation : Demand Obs = 2000, Supply Obs = 2000</span></a>
<a class="sourceLine" id="cb6-192" title="192"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb6-193" title="193"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb6-194" title="194"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb6-195" title="195"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb6-196" title="196"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-197" title="197"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb6-198" title="198"><span class="co">#&gt;   Method              : BFGS</span></a>
<a class="sourceLine" id="cb6-199" title="199"><span class="co">#&gt;   Max Iterations      : 10000</span></a>
<a class="sourceLine" id="cb6-200" title="200"><span class="co">#&gt;   Relative Tolerance  : 1e-08</span></a>
<a class="sourceLine" id="cb6-201" title="201"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb6-202" title="202"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb6-203" title="203"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb6-204" title="204"><span class="co">#&gt; -3.3899420 28.6908902  1.9497497 -0.6543147  3.3398395  6.0967924  1.5864480 </span></a>
<a class="sourceLine" id="cb6-205" title="205"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2     P_DIFF D_VARIANCE S_VARIANCE </span></a>
<a class="sourceLine" id="cb6-206" title="206"><span class="co">#&gt; 26.6853581  2.1696502  1.5962938  4.5814415 -0.0007971  0.6012371  1.0378385 </span></a>
<a class="sourceLine" id="cb6-207" title="207"><span class="co">#&gt;        RHO </span></a>
<a class="sourceLine" id="cb6-208" title="208"><span class="co">#&gt;  0.0000000 </span></a>
<a class="sourceLine" id="cb6-209" title="209"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-210" title="210"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb6-211" title="211"><span class="co">#&gt;             Estimate Std. Error    z value      Pr(z)</span></a>
<a class="sourceLine" id="cb6-212" title="212"><span class="co">#&gt; D_P        -3.875716    0.03396 -114.13950  0.000e+00</span></a>
<a class="sourceLine" id="cb6-213" title="213"><span class="co">#&gt; D_CONST    28.891196    0.01875 1540.93773  0.000e+00</span></a>
<a class="sourceLine" id="cb6-214" title="214"><span class="co">#&gt; D_Xd1       2.105016    0.01624  129.59540  0.000e+00</span></a>
<a class="sourceLine" id="cb6-215" title="215"><span class="co">#&gt; D_Xd2      -0.707967    0.01313  -53.92060  0.000e+00</span></a>
<a class="sourceLine" id="cb6-216" title="216"><span class="co">#&gt; D_X1        3.507454    0.01670  210.07124  0.000e+00</span></a>
<a class="sourceLine" id="cb6-217" title="217"><span class="co">#&gt; D_X2        6.246540    0.01583  394.60023  0.000e+00</span></a>
<a class="sourceLine" id="cb6-218" title="218"><span class="co">#&gt; S_P         2.842225    0.05490   51.76647  0.000e+00</span></a>
<a class="sourceLine" id="cb6-219" title="219"><span class="co">#&gt; S_CONST    26.187074    0.03095  846.01070  0.000e+00</span></a>
<a class="sourceLine" id="cb6-220" title="220"><span class="co">#&gt; S_Xs1       2.677787    0.02814   95.16504  0.000e+00</span></a>
<a class="sourceLine" id="cb6-221" title="221"><span class="co">#&gt; S_X1        1.162670    0.02566   45.30858  0.000e+00</span></a>
<a class="sourceLine" id="cb6-222" title="222"><span class="co">#&gt; S_X2        4.188175    0.02428  172.49527  0.000e+00</span></a>
<a class="sourceLine" id="cb6-223" title="223"><span class="co">#&gt; P_DIFF      0.001553    0.02176    0.07137  9.431e-01</span></a>
<a class="sourceLine" id="cb6-224" title="224"><span class="co">#&gt; D_VARIANCE  0.649373    0.01584   41.00771  0.000e+00</span></a>
<a class="sourceLine" id="cb6-225" title="225"><span class="co">#&gt; S_VARIANCE  1.280272    0.03540   36.16826 1.922e-286</span></a>
<a class="sourceLine" id="cb6-226" title="226"><span class="co">#&gt; RHO        -0.019191    0.01807   -1.06181  2.883e-01</span></a>
<a class="sourceLine" id="cb6-227" title="227"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-228" title="228"><span class="co">#&gt; -2 log L: 6722.67</span></a></code></pre></div>
</div>
<div id="model-selection" class="section level3">
<h3>Model selection</h3>
<p>The deterministic adjustment model has price dynamics that are analogous to excess demand and estimates one extra parameter. The directional model estimates one parameter less as the model does not have enough equations to identify prices in both demand and supply equations. The estimated parameters are summarized as follows.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">da_coef &lt;-<span class="st"> </span><span class="kw">coef</span>(da_fit)</a>
<a class="sourceLine" id="cb7-2" title="2">coef_names &lt;-<span class="st"> </span><span class="kw">names</span>(da_coef)</a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4">sim_coef &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb7-5" title="5">  alpha_d, beta_d0, beta_d, eta_d,</a>
<a class="sourceLine" id="cb7-6" title="6">  alpha_s, beta_s0, beta_s, eta_s,</a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-8" title="8">  sigma_d, sigma_s,</a>
<a class="sourceLine" id="cb7-9" title="9">  rho_ds</a>
<a class="sourceLine" id="cb7-10" title="10">)</a>
<a class="sourceLine" id="cb7-11" title="11"></a>
<a class="sourceLine" id="cb7-12" title="12">coef_tbl &lt;-<span class="st"> </span><span class="cf">function</span>(fit) {</a>
<a class="sourceLine" id="cb7-13" title="13">    tibble<span class="op">::</span><span class="kw">tibble</span>(<span class="dt">coef =</span> <span class="kw">names</span>(<span class="kw">coef</span>(fit)),<span class="op">!!</span><span class="kw">substitute</span>(fit) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">coef</span>(fit))</a>
<a class="sourceLine" id="cb7-14" title="14">}</a>
<a class="sourceLine" id="cb7-15" title="15"></a>
<a class="sourceLine" id="cb7-16" title="16">comp &lt;-<span class="st"> </span><span class="kw">coef_tbl</span>(da_fit) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(<span class="kw">coef_tbl</span>(bs_fit), <span class="dt">by =</span> <span class="st">&quot;coef&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(<span class="kw">coef_tbl</span>(eq_reg), <span class="dt">by =</span> <span class="st">&quot;coef&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(<span class="kw">coef_tbl</span>(eq_fit), <span class="dt">by =</span> <span class="st">&quot;coef&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sim =</span> sim_coef) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sim =</span> sim_coef,</a>
<a class="sourceLine" id="cb7-22" title="22">                  <span class="dt">da_fit_err =</span> <span class="kw">abs</span>(da_fit <span class="op">-</span><span class="st"> </span>sim),</a>
<a class="sourceLine" id="cb7-23" title="23">                  <span class="dt">bs_fit_err =</span> <span class="kw">abs</span>(bs_fit <span class="op">-</span><span class="st"> </span>sim),</a>
<a class="sourceLine" id="cb7-24" title="24">                  <span class="dt">eq_fit_err =</span> <span class="kw">abs</span>(eq_fit <span class="op">-</span><span class="st"> </span>sim)) </a>
<a class="sourceLine" id="cb7-25" title="25"></a>
<a class="sourceLine" id="cb7-26" title="26">comp</a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">#&gt; # A tibble: 15  9</span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">#&gt;    coef     da_fit bs_fit  eq_reg  eq_fit   sim da_fit_err bs_fit_err eq_fit_err</span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="co">#&gt;  1 D_P    -3.88    -3.51  -3.88   -3.88   -3.9     0.0243     0.391      0.0234 </span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">#&gt;  2 D_CON 28.9     29.1   28.9    28.9    28.9     0.00880    0.223      0.00910</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">#&gt;  3 D_Xd1   2.11     2.07   2.11    2.11    2.1     0.00502    0.0281     0.00505</span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co">#&gt;  4 D_Xd2  -0.708   -0.709 -0.708  -0.708  -0.7     0.00797    0.00883    0.00795</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#&gt;  5 D_X1    3.51     3.37   3.51    3.51    3.5     0.00745    0.135      0.00749</span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#&gt;  6 D_X2    6.25     6.14   6.25    6.25    6.25    0.00346    0.106      0.00345</span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#&gt;  7 S_P     2.84     2.07   2.84    2.84    2.8     0.0422     0.729      0.0430 </span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#&gt;  8 S_CON 26.2     27.9   26.2    26.2    26.2     0.0129     1.65       0.0139 </span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">#&gt;  9 S_Xs1   2.68     2.58   2.68    2.68    2.65    0.0278     0.0672     0.0278 </span></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co">#&gt; 10 S_X1    1.16     1.45   1.16    1.16    1.15    0.0127     0.298      0.0127 </span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co">#&gt; 11 S_X2    4.19     4.40   4.19    4.19    4.2     0.0118     0.199      0.0118 </span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">#&gt; 12 P_DIFF  0.00155 NA     NA      NA      NA      NA         NA         NA      </span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">#&gt; 13 D_VAR  0.649    0.639  0.650   0.649   0.8     0.151      0.161      0.151  </span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">#&gt; 14 S_VAR  1.28     1.12   1.28    1.28    1.1     0.180      0.0249     0.180  </span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">#&gt; 15 RHO    -0.0192  -0.471 -0.0192 -0.0192  0       0.0192     0.471      0.0192</span></a></code></pre></div>
<p>Since we have used simulated data, we can calculate the average absolute error of the parameter estimation for each of the models. The population values are unknown in practice, and this calculation is impossible.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">model_errors &lt;-<span class="st"> </span><span class="kw">colMeans</span>(comp[, <span class="kw">grep</span>(<span class="st">&quot;err&quot;</span>, <span class="kw">colnames</span>(comp))], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb8-2" title="2">model_errors</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; da_fit_err bs_fit_err eq_fit_err </span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; 0.03675054 0.32116445 0.03684207</span></a></code></pre></div>
<p>Moreover, the average absolute error cannot provide an overall estimation assessment as the market models have different parameter spaces. To assess the overall model performance, one can instead use an information criterion.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">fits &lt;-<span class="st"> </span><span class="kw">c</span>(da_fit, bs_fit, eq_fit)</a>
<a class="sourceLine" id="cb9-2" title="2">model_names &lt;-<span class="st"> </span><span class="kw">sapply</span>(fits, <span class="cf">function</span>(m) m<span class="op">@</span>model_type_string)</a>
<a class="sourceLine" id="cb9-3" title="3">model_obs &lt;-<span class="st"> </span><span class="kw">sapply</span>(fits, nobs)</a>
<a class="sourceLine" id="cb9-4" title="4">aic &lt;-<span class="st"> </span><span class="kw">sapply</span>(fits, AIC)</a>
<a class="sourceLine" id="cb9-5" title="5">df &lt;-<span class="st"> </span><span class="kw">sapply</span>(fits, <span class="cf">function</span>(m) <span class="kw">attr</span>(<span class="kw">logLik</span>(m), <span class="st">&quot;df&quot;</span>))</a>
<a class="sourceLine" id="cb9-6" title="6">seltbl &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(<span class="dt">Model =</span> model_names, <span class="dt">AIC =</span> aic,</a>
<a class="sourceLine" id="cb9-7" title="7">                         <span class="dt">D.F =</span> df, <span class="dt">Obs. =</span> model_obs,</a>
<a class="sourceLine" id="cb9-8" title="8">                         <span class="dt">Abs.Error =</span> model_errors) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(AIC)</a>
<a class="sourceLine" id="cb9-10" title="10">seltbl</a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; # A tibble: 3  5</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt;   Model                      AIC   D.F  Obs. Abs.Error</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt;   &lt;chr&gt;                    &lt;dbl&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt; 1 Equilibrium              6751.    14  4000    0.0368</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#&gt; 2 Deterministic Adjustment 6753.    15  4000    0.0368</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#&gt; 3 Basic                    8367.    14  4000    0.321</span></a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
